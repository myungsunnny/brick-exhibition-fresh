<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" /><meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>ëŒ€ë¶ˆì´ˆ ë¸Œë¦­ëª¨ë¸ ì „ì‹œê´€</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:Arial,sans-serif;min-height:100vh;
      background:linear-gradient(135deg,#667eea,#764ba2);color:#333;}
    .container{max-width:1200px;margin:0 auto;padding:20px;}
    header{text-align:center;position:relative;color:white;margin-bottom:40px;}
    .header-buttons{position:absolute;top:0;right:0;display:flex;gap:10px;}
    .header-btn{padding:10px 20px;border:none;border-radius:25px;
      background:rgba(255,255,255,0.2);color:white;cursor:pointer;
      backdrop-filter:blur(10px);transition:0.3s;font-size:0.9rem;}
    .header-btn:hover{background:rgba(255,255,255,0.3);transform:translateY(-2px);}
    .header-btn.active{background:rgba(255,255,255,0.4);}
    h1{font-size:2.5rem;text-shadow:2px 2px 4px rgba(0,0,0,0.3);margin-bottom:10px;}
    .subtitle{font-size:1.1rem;opacity:0.9;margin-bottom:20px;}
    .search-container{margin-bottom:30px;text-align:center;}
    .search-container input{padding:12px 20px;border:2px solid rgba(255,255,255,0.3);
      border-radius:25px;background:rgba(255,255,255,0.1);color:white;backdrop-filter:blur(10px);
      font-size:1rem;width:300px;text-align:center;}
    .search-container input::placeholder{color:rgba(255,255,255,0.7);}
    .filters{display:flex;justify-content:center;gap:15px;margin-bottom:10px;flex-wrap:wrap;}
    .filter-btn{padding:10px 20px;border:none;border-radius:25px;
      background:rgba(255,255,255,0.2);color:white;cursor:pointer;
      backdrop-filter:blur(10px);transition:0.3s;}
    .filter-btn:hover,.filter-btn.active{background:rgba(255,255,255,0.3);transform:translateY(-2px);}
    .grade-info-box{display:none;background:#fffbe8;border:1px solid #ffe082;border-radius:10px;
      padding:18px;margin-bottom:25px;color:#6e5a04;font-size:1.05rem;text-align:center;}
    .grade-info-box strong{font-size:1.2rem;display:block;margin-bottom:6px;}
    .gallery{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:30px;margin-bottom:40px;}
    .artwork-card{background:white;border-radius:15px;overflow:hidden;
      box-shadow:0 10px 30px rgba(0,0,0,0.2);transition:0.3s;position:relative;}
    .artwork-image{width:100%;height:200px;background:linear-gradient(45deg,#f0f0f0,#e0e0e0);
      display:flex;align-items:center;justify-content:center;overflow:hidden;}
    .artwork-image img{width:100%;height:100%;object-fit:cover;}
    .artwork-info{padding:20px;}
    .artwork-title{font-size:1.3rem;font-weight:bold;color:#2c3e50;margin-bottom:8px;}
    .artwork-author{color:#7f8c8d;margin-bottom:10px;}
    .artwork-description{color:#555;line-height:1.6;}
    /* ê´€ë¦¬ì */
    .upload-panel,.admin-panel{display:none;background:white;
      border-radius:15px;padding:20px;margin-bottom:30px;
      box-shadow:0 10px 30px rgba(0,0,0,0.2);}
    .admin-tabs{display:flex;gap:15px;margin-bottom:20px;}
    .admin-tab-btn{padding:12px 24px;border:none;border-radius:30px;
      background:#f4f6fb;color:#555;font-size:1rem;cursor:pointer;transition:0.2s;}
    .admin-tab-btn.active{background:linear-gradient(45deg,#667eea,#764ba2);color:white;}
    .admin-tab-panel{display:none;background:white;border-radius:16px;
      padding:25px;box-shadow:0 2px 10px rgba(0,0,0,0.1);margin-bottom:20px;}
    .admin-tab-panel.active{display:block;}
    table{width:100%;border-collapse:collapse;margin-top:10px;}
    th,td{padding:8px;border:1px solid #ddd;text-align:left;}
    th{background:#f4f4f4;}
    tr.draggable{cursor:move;}
    .btn{padding:8px 14px;border:none;border-radius:6px;cursor:pointer;}
    .btn-danger{background:#e74c3c;color:white;}
    .btn-primary{background:linear-gradient(45deg,#667eea,#764ba2);color:white;}
    @media(max-width:768px){.gallery{grid-template-columns:1fr;}.admin-tabs{flex-wrap:wrap;}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="header-buttons">
        <button class="header-btn" id="btnUploadToggle">ğŸ“¸ ì‘í’ˆ ì˜¬ë¦¬ê¸°</button>
        <button class="header-btn" id="btnAdminToggle">ğŸ”§ ê´€ë¦¬ì ëª¨ë“œ</button>
      </div>
      <h1>ğŸ§± ëŒ€ë¶ˆì´ˆë“±í•™êµ ë¸Œë¦­ëª¨ë¸ ì „ì‹œê´€</h1>
      <p class="subtitle">ì°½ì˜ì ì¸ ë¸Œë¦­ëª¨ë¸ í™œë™ìœ¼ë¡œ ë§Œë“  ë©‹ì§„ ì‘í’ˆë“¤ì„ ë§Œë‚˜ë³´ì„¸ìš”</p>
    </header>

    <div class="search-container">
      <input type="text" id="searchInput" placeholder="ì‘í’ˆëª… or í•™ìƒ ì´ë¦„ ê²€ìƒ‰..."/>
    </div>

    <div class="filters">
      <button class="filter-btn active" data-cat="all">ì „ì²´</button>
      <button class="filter-btn" data-cat="1í•™ë…„">1í•™ë…„</button>
      <button class="filter-btn" data-cat="2í•™ë…„">2í•™ë…„</button>
      <button class="filter-btn" data-cat="3í•™ë…„">3í•™ë…„</button>
      <button class="filter-btn" data-cat="4í•™ë…„">4í•™ë…„</button>
      <button class="filter-btn" data-cat="5í•™ë…„">5í•™ë…„</button>
      <button class="filter-btn" data-cat="6í•™ë…„">6í•™ë…„</button>
    </div>

    <div class="grade-info-box" id="gradeInfo">
      <strong id="gradeTitle"></strong>
      <p id="gradeDesc"></p>
    </div>

    <div class="gallery" id="gallery">
      <!-- ì¹´ë“œ ì˜ˆì‹œ/JSë¡œ ë Œë”ë§ -->
    </div>

    <!-- 1) ì‘í’ˆ ì—…ë¡œë“œ í¼ -->
    <div class="upload-panel" id="uploadPanel">
      <h2>ğŸ“¸ ìƒˆ ì‘í’ˆ ë“±ë¡/ìˆ˜ì •</h2>
      <!-- í¼ êµ¬í˜„ ìë¦¬ -->
      <p>ì‘í’ˆ ë“±ë¡/ìˆ˜ì • í¼ ìœ„ì¹˜ (í•„ìš” ì‹œ JS/ë°±ì—”ë“œ ì—°ë™)</p>
    </div>

    <!-- 2) ê´€ë¦¬ì íŒ¨ë„ -->
    <div class="admin-panel" id="adminPanel">
      <div class="admin-tabs">
        <button class="admin-tab-btn active" data-tab="artworks">ğŸ–¼ï¸ ì‘í’ˆ ê´€ë¦¬</button>
        <button class="admin-tab-btn" data-tab="comments">ğŸ’¬ ëŒ“ê¸€ ê´€ë¦¬</button>
        <button class="admin-tab-btn" data-tab="users">ğŸ‘¤ ì‚¬ìš©ì ê´€ë¦¬</button>
        <button class="admin-tab-btn" data-tab="settings">âš™ï¸ ì‚¬ì´íŠ¸ ì„¤ì •</button>
      </div>

      <!-- ì‘í’ˆ ê´€ë¦¬ -->
      <div class="admin-tab-panel active" id="tab_artworks">
        <h3>ğŸ–¼ï¸ ì‘í’ˆ ê´€ë¦¬</h3>
        <button class="btn btn-danger" onclick="deleteSelected()">ì„ íƒ ì‘í’ˆ ì¼ê´„ ì‚­ì œ</button>
        <button class="btn btn-primary" onclick="exportData()">ë°ì´í„° JSON ë‚´ë³´ë‚´ê¸°</button>
        <table>
          <thead><tr>
            <th><input type="checkbox" id="chkAllArt"/></th>
            <th>#</th><th>ì œëª©</th><th>ì‘ê°€</th><th>í•™ë…„</th><th>ê´€ë¦¬</th>
          </tr></thead>
          <tbody id="tblArtworks"></tbody>
        </table>
      </div>

      <!-- ëŒ“ê¸€ ê´€ë¦¬ -->
      <div class="admin-tab-panel" id="tab_comments">
        <h3>ğŸ’¬ ëŒ“ê¸€ ê´€ë¦¬</h3>
        <button class="btn btn-danger" onclick="deleteSelectedComments()">ì„ íƒ ëŒ“ê¸€ ì‚­ì œ</button>
        <table>
          <thead><tr>
            <th><input type="checkbox" id="chkAllComm"/></th>
            <th>ì‘í’ˆì œëª©</th><th>ì‘ì„±ì</th><th>ë‚´ìš©</th><th>ì‘ì„±ì¼</th><th>ê´€ë¦¬</th>
          </tr></thead>
          <tbody id="tblComments"></tbody>
        </table>
      </div>

      <!-- ì‚¬ìš©ì ê´€ë¦¬ -->
      <div class="admin-tab-panel" id="tab_users">
        <h3>ğŸ‘¤ ì‚¬ìš©ì ê´€ë¦¬</h3>
        <table>
          <thead><tr>
            <th>ì´ë¦„</th><th>ê°€ì…ì¼</th><th>ì‘í’ˆ ìˆ˜</th><th>ëŒ“ê¸€ ìˆ˜</th><th>ë°›ì€ ì¢‹ì•„ìš”</th><th>ë§ˆì§€ë§‰ í™œë™</th>
          </tr></thead>
          <tbody id="tblUsers"></tbody>
        </table>
      </div>

      <!-- ì‚¬ì´íŠ¸ ì„¤ì • -->
      <div class="admin-tab-panel" id="tab_settings">
        <h3>âš™ï¸ ì‚¬ì´íŠ¸ ì„¤ì •</h3>
        <div>
          <h4>ê¸°ë³¸ ì •ë³´</h4>
          <label>ì‚¬ì´íŠ¸ ì œëª©: <input type="text" id="siteTitle"/></label><br/>
          <label>ë¶€ì œ: <input type="text" id="siteSubtitle"/></label><br/>
          <label>ë¡œê³ : <input type="file" id="siteLogo"/></label>
        </div>
        <div>
          <h4>ë³´ì•ˆ ì„¤ì •</h4>
          <label>ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸: <input type="password" id="adminPwd"/></label><br/>
          <label>ì—…ë¡œë“œ ë¹„ë°€ë²ˆí˜¸: <input type="password" id="uploadPwd"/></label><br/>
          <label><input type="checkbox" id="reqUploadPwd"/> ì—…ë¡œë“œ ì‹œ ë¹„ë°€ë²ˆí˜¸ í•„ìš”</label>
        </div>
        <div>
          <h4>í•™ë…„ë³„ ì•ˆë‚´ë¬¸êµ¬</h4>
          <div id="gradeSettingList">
            <!-- JS ê¸°ë°˜ ë°˜ë³µ ìƒì„± -->
          </div>
        </div>
        <div>
          <h4>ëŒ“ê¸€ ê¸°ëŠ¥ ì œì–´</h4>
          <label><input type="checkbox" id="enableComments"/> ëŒ“ê¸€ í—ˆìš©</label><br/>
          <label><input type="checkbox" id="reqApproval"/> ê´€ë¦¬ì ìŠ¹ì¸ í›„ ë…¸ì¶œ</label>
        </div>
        <div>
          <h4>ë°ì´í„° ì´ˆê¸°í™”</h4>
          <button class="btn btn-danger" onclick="resetAll()">ëª¨ë“  ë°ì´í„° ì´ˆê¸°í™”</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ì´ˆê¸° ë°ì´í„° ë°°ì—´ ì„ ì–¸
    let artworks=[],comments=[],users=[],settings={gradeInfo:{}};
    let editingArtId=null;

    // íƒ­/í† ê¸€ ì´ë²¤íŠ¸
    document.getElementById('btnUploadToggle').onclick=()=>{
      toggleAdmin(false); toggleUpload(!isVisible('uploadPanel'));
    };
    document.getElementById('btnAdminToggle').onclick=()=>{
      toggleUpload(false); toggleAdmin(!isVisible('adminPanel'));
    };
    document.querySelectorAll('.admin-tab-btn').forEach(btn=>{
      btn.onclick=()=>{switchTab(btn.dataset.tab);};
    });

    function toggleUpload(show){ document.getElementById('uploadPanel').style.display= show?'block':'none'; }
    function toggleAdmin(show){
      document.getElementById('adminPanel').style.display= show?'block':'none';
      if(show){ refreshAdminTables(); }
    }
    function isVisible(id){ return document.getElementById(id).style.display==='block'; }
    function switchTab(tab){
      document.querySelectorAll('.admin-tab-btn').forEach(b=>b.classList.remove('active'));
      document.querySelectorAll('.admin-tab-panel').forEach(p=>p.classList.remove('active'));
      document.querySelector(`.admin-tab-btn[data-tab="${tab}"]`).classList.add('active');
      document.getElementById(`tab_${tab}`).classList.add('active');
      if(tab==='comments') loadComments();
      if(tab==='users') loadUsers();
      if(tab==='settings') loadSettings();
    }

    // í•™ë…„ ì•ˆë‚´ë°•ìŠ¤
    const gradeDefs={'1í•™ë…„':'ì²˜ìŒ...',/*...*/,'6í•™ë…„':'íŒ€í”„ë¡œì íŠ¸...'};
    const gradeData={
      '1í•™ë…„':{title:'1í•™ë…„',desc:'ì˜ˆì‹œ1'},
      '2í•™ë…„':{title:'2í•™ë…„',desc:'ì˜ˆì‹œ2'},
      /*...*/,'6í•™ë…„':{title:'6í•™ë…„',desc:'ì˜ˆì‹œ6'}
    };
    document.querySelectorAll('.filter-btn').forEach(btn=>{
      btn.onclick=()=>{
        document.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        const cat=btn.dataset.cat;
        const gi=document.getElementById('gradeInfo');
        if(gradeData[cat]){
          gi.style.display='block';
          document.getElementById('gradeTitle').textContent=gradeData[cat].title;
          document.getElementById('gradeDesc').innerHTML=gradeData[cat].desc;
        } else gi.style.display='none';
        renderGallery(cat);
      };
    });

    function renderGallery(cat){
      const gallery = document.getElementById('gallery');
      gallery.innerHTML='';
      const list = artworks.filter(a=>cat==='all'||a.grade===cat);
      list.forEach(a=>{
        const div = document.createElement('div');
        div.className='artwork-card'; // + í´ë¦­/ì¢‹ì•„ìš” ë“± êµ¬í˜„ ì¶”ê°€
        div.innerHTML=`
          <div class="artwork-image"><img src="${a.image}" alt="${a.title}"/></div>
          <div class="artwork-info">
            <div class="artwork-title">${a.title}</div>
            <div class="artwork-author">${a.author} (${a.grade})</div>
            <div class="artwork-description">${a.description}</div>
          </div>`;
        gallery.appendChild(div);
      });
    }

    // ê´€ë¦¬ì í…Œì´ë¸”
    function refreshAdminTables(){
      loadArtworksTable();
      loadComments();
      loadUsers();
      loadSettings();
    }
    function loadArtworksTable(){
      const tb=document.getElementById('tblArtworks');
      tb.innerHTML='';
      artworks.forEach((a,i)=>{
        const tr=document.createElement('tr');
        tr.className='draggable';
        tr.draggable=true;
        tr.ondragstart=e=>e.dataTransfer.setData('text/plain',i);
        tr.ondragover=e=>e.preventDefault();
        tr.ondrop=e=>{
          const from=+e.dataTransfer.getData('text');
          const to=i;
          const [m]=artworks.splice(from,1);
          artworks.splice(to,0,m);
          refreshAdminTables();
        };
        tr.innerHTML=`
          <td><input type="checkbox" class="chkArt" value="${a.id}"/></td>
          <td>${i+1}</td><td>${a.title}</td><td>${a.author}</td><td>${a.grade}</td>
          <td>
            <button class="btn" onclick="editArt('${a.id}')">ìˆ˜ì •</button>
            <button class="btn btn-danger" onclick="delArt('${a.id}')">ì‚­ì œ</button>
          </td>`;
        tb.appendChild(tr);
      });
      document.getElementById('chkAllArt').onclick=e=>{
        document.querySelectorAll('.chkArt').forEach(cb=>cb.checked=e.target.checked);
      };
    }
    function deleteSelected(){
      const sel=Array.from(document.querySelectorAll('.chkArt:checked')).map(cb=>cb.value);
      if(!sel.length)return alert('ì„ íƒëœ ì‘í’ˆ ì—†ìŒ');
      if(!confirm(`ì„ íƒëœ ${sel.length}ê°œ ì‘í’ˆ ì‚­ì œ?`))return;
      artworks=artworks.filter(a=>!sel.includes(a.id));
      refreshAdminTables();
      renderGallery('all');
    }
    function delArt(id){
      if(!confirm('ì‘í’ˆ ì‚­ì œ?'))return;
      artworks=artworks.filter(a=>a.id!==id);
      refreshAdminTables();renderGallery('all');
    }
    function editArt(id){
      const a = artworks.find(x=>x.id===id);
      alert(`${a.title} ìˆ˜ì • ê¸°ëŠ¥ êµ¬í˜„ í•„ìš”`);
      // ì—…ë¡œë“œí¼ ë„ìš°ê³  ë‚´ìš© ì±„ìš°ê¸°, ì´í›„ ì €ì¥
    }

    // ëŒ“ê¸€
    function loadComments(){
      const tb=document.getElementById('tblComments');
      tb.innerHTML='';
      comments.forEach(c=>{
        const art = artworks.find(a=>a.id===c.artworkId);
        const tr=document.createElement('tr');
        tr.innerHTML=`
          <td><input type="checkbox" class="chkComm" value="${c.id}"/></td>
          <td>${art?art.title:'-'}</td><td>${c.author}</td>
          <td contenteditable>${c.content}</td>
          <td>${new Date(c.createdAt).toLocaleDateString()}</td>
          <td>
            <button class="btn btn-danger" onclick="delComm('${c.id}')">ì‚­ì œ</button>
          </td>`;
        tb.appendChild(tr);
      });
    }
    function deleteSelectedComments(){
      const sel=Array.from(document.querySelectorAll('.chkComm:checked')).map(cb=>cb.value);
      comments = comments.filter(c=>!sel.includes(c.id));
      loadComments();
    }
    function delComm(id){
      if(!confirm('ëŒ“ê¸€ ì‚­ì œ?'))return;
      comments=comments.filter(c=>c.id!==id);
      loadComments();
    }

    // ì‚¬ìš©ì
    function loadUsers(){
      const tb=document.getElementById('tblUsers');
      tb.innerHTML='';
      users.forEach(u=>{
        const arts = artworks.filter(a=>a.authorId===u.id).length;
        const comms = comments.filter(c=>c.authorId===u.id).length;
        const likes = u.likesReceived||0;
        const tr=document.createElement('tr');
        tr.innerHTML=`<td>${u.name}</td><td>${new Date(u.joined).toLocaleDateString()}</td>
          <td>${arts}</td><td>${comms}</td><td>${likes}</td>
          <td>${new Date(u.lastActive).toLocaleDateString()}</td>`;
        tb.appendChild(tr);
      });
    }

    // ì„¤ì •
    function loadSettings(){
      document.getElementById('siteTitle').value=settings.siteTitle||'';
      document.getElementById('siteSubtitle').value=settings.siteSubtitle||'';
      document.getElementById('adminPwd').value=settings.adminPwd||'';
      document.getElementById('uploadPwd').value=settings.uploadPwd||'';
      document.getElementById('reqUploadPwd').checked=settings.reqUploadPwd||false;
      document.getElementById('enableComments').checked=settings.enableComments!==false;
      document.getElementById('reqApproval').checked=settings.reqApproval||false;
      const container=document.getElementById('gradeSettingList');
      container.innerHTML='';
      ['1í•™ë…„','2í•™ë…„','3í•™ë…„','4í•™ë…„','5í•™ë…„','6í•™ë…„'].forEach(g=>{
        const div=document.createElement('div');
        div.innerHTML=`
          <label>${g} ì•ˆë‚´:<br/>
          <textarea data-grade="${g}" rows="2">${settings.gradeInfo[g]||''}</textarea></label>`;
        container.appendChild(div);
      });
    }

    // JSON ë‚´ë³´ë‚´ê¸°
    function exportData(){
      const data=JSON.stringify({artworks,comments,users,settings},null,2);
      const blob=new Blob([data],{type:'application/json'});
      const a=document.createElement('a');
      a.href=URL.createObjectURL(blob);
      a.download='gallery_backup.json';
      a.click();
    }

    // ì´ˆê¸°í™”
    function resetAll(){
      if(!confirm('ëª¨ë“  ë°ì´í„° ì •ë§ ì´ˆê¸°í™”í• ê¹Œìš”?'))return;
      artworks=[];comments=[];users=[];settings.gradeInfo={};
      refreshAdminTables();renderGallery('all');
      alert('ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
    }

    // ìµœì´ˆ í˜¸ì¶œ: ì´ˆê¸° ë°ì´í„° ìƒ˜í”Œ
    (()=>{
      artworks=[{id:'a1',title:'ìƒ˜í”Œì‘í’ˆ',author:'í™ê¸¸ë™',authorId:'u1',grade:'1í•™ë…„',
        description:'ìƒ˜í”Œ ì‘í’ˆì…ë‹ˆë‹¤.',image:'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=400&h=300',createdAt:new Date().toISOString()}];
      comments=[{id:'c1',artworkId:'a1',author:'ê¹€ì² ìˆ˜',authorId:'u2',content:'ë©‹ì ¸ìš”!',createdAt:new Date().toISOString()}];
      users=[{id:'u1',name:'í™ê¸¸ë™',joined:new Date().toISOString(),lastActive:new Date().toISOString(),likesReceived:0},
             {id:'u2',name:'ê¹€ì² ìˆ˜',joined:new Date().toISOString(),lastActive:new Date().toISOString(),likesReceived:0}];
      settings.siteTitle='ëŒ€ë¶ˆì´ˆ ë¸Œë¦­ëª¨ë¸';
      settings.siteSubtitle='ì°½ì˜ ë¸Œë¦­ ì „ì‹œê´€';
      settings.gradeInfo={'1í•™ë…„':'ì²˜ìŒ ë§Œë‚˜ëŠ”...', '2í•™ë…„':'ì¡°ë¦½...', '3í•™ë…„':'ì„¤ê³„...'};

      renderGallery('all');
    })();
  </script>
</body>
</html>
